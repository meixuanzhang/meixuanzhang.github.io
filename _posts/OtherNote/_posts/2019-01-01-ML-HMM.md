---
layout: post
title: 隐马尔可夫模型（Hidden Markov Model，HMM）
date:   2019-01-01
categories: 
---

# 隐马尔可夫模型概念

当需要计算可观测序列概率时，可以使用Markov Chain,但很多时候我们感兴趣的是隐藏状态，没办法直接观测,例如：句子语法标记，我们不能直接观测到每次词标记，需要从词序列推断出词的标记。把标记叫作隐藏状态，无法直接观察出来。词记作观测值。    
HMM通过隐藏状态和观测值，建立概率模型，描述了一个含有隐含未知参数的马尔可夫过程。

**Notation**  

$$Q$$:隐藏状态**集合**$${q_{1},q_{2}..,q_{N}}$$  

$$V$$:观测值**集合**$${v_{1},v_{2}..,v_{M}}$$   

$$O$$:观测值序列 $$(o_{1},..o_{t},o_{t+1}...)$$

$$I$$:隐藏状态序列$$(i_{1},..i_{t},i_{t+1}...)$$

$$A$$:从一个隐藏状态转到另一个隐藏状态的概率矩阵,维度N*N    

$$B$$:不同隐藏状态下不同测量值概率矩阵，维度是N*M  

$$\pi$$:初始化隐藏状态概率分布


$$A=[a_{ij}]_{N \ast N}$$   

其中$$a_{ij}=P(i_{t+1}=q_{j} \mid i_{t}=q_{i}), i=1,2,3,..N;j=1,2,..N$$    

表示从隐藏状态$$q_{i}$$(t时刻的状态)转到隐藏状态$$q_{j}$$(t+1时刻的状态),也表示在时刻t处于状态$$q_{i}$$的条件下时刻t+1转移到状态$$q_{j}$$的概率。   

$$B=[b_{j}(k)]_{N \ast M}$$

其中$$b_{j}(k)=P(o_{t}=v_{k} \mid i_{t}=q_{j}), i=1,2,3,..N;j=1,2,..N$$  

表示在时刻t处于状态$$q_{i}$$的条件下生成观测值$$v_{k}$$  

$$\pi_{i}=P(i_{1}=q_{i}),i=1,2,..N$$  

隐马尔可夫模型(HMM)由初始概率状态$$\pi$$、隐藏转移概率矩阵$$A$$和观测值概率矩阵$$B$$决定，$$\pi ,A$$决定隐藏状态序列，$$B$$决定观测值序列，$$A,B,\pi$$是隐马尔可夫模型的三要素，用三元符号表示$$\lambda=(A,B,\pi)$$。  

隐藏状态转移概率矩阵$$A$$与初始状态概率向量$$\pi$$确定了隐藏的马尔可夫链，生成不可观测的状态序列，观测值概率矩阵$$B$$确定了如何从隐藏状态生成观测值，与隐藏状态序列综合确定了如何产生观测值序列。

隐马尔可夫模型的两个基本假设：  
1、齐次马尔可夫性假设，即假设隐藏的马尔可夫链在任意时刻t+1的隐藏状态依赖于t时刻的隐藏状态，与其他时刻的隐藏状态及观测值无关。  

$$P(i_{t+1} \mid i_{t},..i_{1},o_{t}..o_{1})=P(i_{t+1} \mid i_{t}), t=1,2,...T$$   

2、观测值独立性假设。即假设任意时刻的观测值只依赖于该时刻的马尔可夫链的隐藏状态，与其他观测值及隐藏状态无关。
 
$$P(o_{t} \mid i_{t},..i_{1},o_{t}..o_{1})=P(o_{t} \mid i_{t})$$   

# 观测值序列生成过程

输入：隐马尔可夫模型$$\lambda=(A,B,\pi)$$，观测序列长度T；  
输出：观测序列$$O=(o_{1},o_{2},...o_{T}})$$  
1、按照初始状态分布$$\pi$$产生隐藏状态$$i_{1}$$
2、令$$t=1$$
3、按照隐藏状态$$i_{t}$$的观测概率分布$$b_{i_{t}}(k)$$生成观测$$o_{t}$$
4、按照隐藏状态$$i_{t}$$的状态转移概率分布$$\{a_{i_{t}i_{t+1}}\}$$产生隐藏状态$$i_{t+1}$$
5、令$$t=t+1:$$如果$$t<T$$,转步3；否则终止

# 隐马尔可夫模型的3种问题
1、概率计算问题。给定模型$$\lambda=(A,B,\pi)$$和观测序列$$O=(o_{1},o_{2},..,o_{T})$$，计算在模型$$\lambda$$下观测序列$$O$$出现的概率$$P(O \mid \lambda)$$。
2、







参考：  
李航《统计学习》
