---
layout: post
title: 马尔可夫性质、过程、链、平稳分布
date:   2019-01-01
categories: 
---

# 马尔可夫性质、过程、链
若只取有限个或可数个值的随机过程$${X_{n},n=0,1,2...}$$。过程可知的集合将以非负整数集$${0,1,2...}$$来表示。若$$X_{n}=i$$，就说过程在时刻n处于状态   i，假设每当过程处于状态 i，则在下一时刻将处于状态 j 的概率是固定的$$P_{ij}$$，也即假设对一切状态$$i_{0},i_{1},..,i_{n-1},i,j$$及一切$$n \ge 0$$有：  

$$
P\{X_{n+1}=j \mid X_{n}=i,X_{n-1}=i_{n-1},..,X_{1}=i_{1},X_{0}=i_{0}\}=P\{X_{n+1}=j \mid X_{n}=i\}\\
=P_{ij}
$$

这样的随机过程称为**马尔可夫链（Markov chain）**。给定过去的状态$${X_{0},X_{1}...X_{n-1}}$$及现在的状态$$X_{n}$$,将来的状态$$X_{n+1}$$的条件分布独立于过去的状态，只依赖于现在的状态，这是**马尔可夫性质（Markovian property）**，具有马尔可夫性质的随机过程称为**马尔可夫过程（Markov process）**，它的原始模型是马尔可夫链。

$$P_{ij}$$代表处于状态i的过程下一步转移到状态j的概率。由于概率是非负的，且过程必须转移到某个状态，所以有：  

$$
P_{ij} \ge 0,\ i,j \ge 0; \sum_{j=0}^{\infty} P_{ij} =1,i=0,1....
$$  

以P记一步转移概率$$P_{ij}$$的矩阵，从而：   

$$
\mathbf{P}=\left\{
 \begin{matrix}
   P_{00} & P_{01} & P_{02}&\ldots \\
   P_{10} & P_{11} & P_{12}&\ldots \\
   \vdots\\
   P_{i0} & P_{i1} & P_{i2}&\ldots\\
   \vdots & \vdots & \vdots
  \end{matrix}
  \right\} 
$$  

# 马尔可夫平稳分布   

定义：对于马尔可夫链，一个概率分布$$\{P_{j},j \ge 0 \}$$称为平稳的，若   

$$
P_{j} =\sum_{i=0}^{\infty}P_{i}P_{ij}, j \ge 0
$$

若$$X_{0}的概率分布(P_{j}=P\{X_{0},j \ge 0\})$$是平稳分布，则：   

$$
P\{X_{1}=j\} = \sum_{i=0}^{\infty}P\{X_{i}=j \mid X_{0}=i\}P\{X_{0}=i\}\\
=\sum_{i=0}^{\infty}P_{i}P_{ij}=P_{j}  
$$   

由归纳法得：  

$$
P\{X_{n}=j\} = \sum_{i=0}^{\infty}P\{X_{n}=j \mid X_{n-1}=i\}P\{X_{n-1}=i\}\\
=\sum_{i=0}^{\infty}P_{i}P_{ij}=P_{j}  
$$  

因此，若初始概率是平稳分布，对一切$$n,X_{n}$$有相同的分布。事实上因$$\{X_{n},n \ge 0\}$$是马尔科夫链，由此得知每个$$m \ge 0 ,X_{n},X_{n+1},..,X_{n+m}$$对每个n具有相同的分布，$$\{X_{n},n \ge 0\}$$是一个平稳过程    



**irreducible Markov chain**    

定义n步转移概率$$P^n_{ij}$$为处于状态i的过程经n词转移后处于状态j的概率。 即  
$$
P^n_{ij} = P\{X_{n+m}=j \mid X_{m}=i\},\ n \ge 0,\ i,j \ge 0  \\
P_{ij}^1 = P_{ij}
$$ 

**Chapman-KoLmogorov equations**提供了计算n步转移概率的方法，对一切$$ n ,m \ge 0$$，一切 i, j 有：  

$$
P_{ij}^{n+m} =P\{X_{n+m}=j \mid X_{0}=i\}\\
=\sum_{k=0}^{\infty}P\{X_{n+m}=j,X_{n}=k \mid X_{0}=i\}\\
=\sum_{k=0}^{\infty}P\{ X_{n}=k \mid X_{0}=i\}p\{X_{n+m}=j \mid X_{n}=k ,X_{0}=i\}\\
=\sum_{k=0}^{\infty}P_{ik}^n P_{kj}^m
$$

若以$$P^{(n)}$$记n步转移概率矩阵，由上面式子得：  

$$P^{(n+m)} = P^{(n)} \cdot P^{(m)}$$点代表矩阵乘法  

因此$$p{(n)}=P \cdot P^{(n-1)}=P \cdot P \cdot P^{n-2} =...=P^n$$于是$$P^{(n)}$$可以由矩阵P自乘n次算出。  

若**某个**$$n \ge 0$$有$$P_{ij}^n >0$$,则称从状态i可到达状态j,两个相互可到达的状态i 与 j称为相通的。相通是一种等价关系。
相通的两个状态属于同一类。若只存在一个类，即一切状态彼此相通，称马尔可夫链是**irreducible**

**aperiodic非周期性**  

称状态i有周期t,若对每个不可被t整除的n有$$P_{ii}^n=0$$,且t是具有此性质的最大整数。 
$$
P_{ii}^n=0 for \ n \ne t,2t,...\\
p_{ii}^n \ne 0 for \ n=t,2t,...
$$

如果t =1则称马尔可夫链是**aperiodic** 

**recurrent**  

对于任何状态i 与 j，定义$$f_{ij}^n$$是从 i 出发在时刻n首次转移到 j 的概率：  

$$
f_{ij}^0=0\\
f_{ij}^n = P{X_{n}=j,X_{k} \ne j, k=1,...,n-1 \mid X_{0}=i}
$$

令：  

$$f_{ij}=\sum_{n=1}^{\infty} f_{ij}^n$$  

$$f_{ij}$$表示过程从i出发迟早转移到状态j的概率。若$$f_{jj}=1$$,称状态j是recurrent，否则是transient  

***状态 j 是recurrent当且仅当$$\sum_{n=1}^n P_{jj}^n =\infty$$***

证明：  

从 j 出发最终要回到 j 的概率是1 $$(f_{jj}=1)$$,由马尔可夫性质可知，回到状态 j 在随机过程上就重新开始，然后再次以$$(f_{jj}=1)$$回到 j ,不断重复，因此从 j 出发回到 j 的次数的期望是无限的。但如果$$(f_{jj}\ne 1)$$,每当过程回到 j，将有$$1-f_{jj}$$概率，它永远不再回到 j ,则到达 j 的次数具有有限均值$$1/(1-f_{jj})$$的几何分布，即：  

设$$a=f_{jj}$$：从j出发能回到j的概率  
N：从j出发回到j的次数  
P(N=k)：从 j 出发回到j发生k-1次,第 k 次没回到 j 的概率  

$$
P(N=k)=a^{k-1}(1-a)
$$

$$
E[number \ of \ visit \ to \ j \mid X_{0} =j ] = \infty\\
I_{n} = \left\{ \begin{array}{rl}
1 &\ x_{n} =j \\
0 & x_{n} \ne j
\end{array} \right.\\
E[\sum_{n=0}^{\infty}I_{n} \mid X_{0}=j] = \sum_{n=0}^{\infty}E[I_{n} \mid X_{0}=j]=\sum_{n=1}^n P_{jj}^n
$$


***如果状态 i 是recurrent,i 和 j 是相通的，则 j 是recurrent ***

证明：  
i和j相通则，则m与n使得$$P_{ij}^n>0,P_{ji}^n>0$$。现在对任意的$$s \ge 0 $$有：  

$$  
P_{jj}^{m+n+s} =\sum_{i=0}^{\infty}P_{ji}^mP_{ii}^sP_{ij}^n\ge P_{ji}^mP_{ii}^sP_{ij}^n\\
\sum_{s} P_{jj}^{m+n+s} /ge P_{ji}^mP_{ij}^n\sum_{s}P_{ii}^s=\infty
$$

一个 irreducible aperiodic 马尔可夫链只会出现以下两种情形：（irreducible：一切状态彼此相通，aperiodic P不为0）  

***如果状态 i 和 j 是相通的，j 是recurrent，则$$f_{ij}=1$$ ***  

周期  
不可约
常返，滑过  会回到，不会回到


