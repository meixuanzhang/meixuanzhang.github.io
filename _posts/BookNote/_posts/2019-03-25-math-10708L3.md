---
layout: post
title: 译Lecture 3 Undirected Graphical Models
date:   2019-03-25
categories: ["Probabilistic Graphical Models"]
---  

无向图形模型简介。  

# 回顾

除了上节课中介绍的I-map概念外，今天的课还包括最小的I-map。  

**最小I-maps**   

如果DAG $$g$$是分布$$P$$的I-map，并且如果从$$g$$中移除任意一条边它将不再是I-map，则它是最小I-map。 

+ 一个分布可以有几个最小I-map，每个对应于一个特定的节点顺序。  

+ $$g$$是$$P$$的最小I-map，这远远不能保证$$g$$捕获$$P$$中的独立结构。


# “Bayes-ball”算法     

我们可以应用“Bayes-ball”算法直接从图模型中检索独立性。我们说给定Y时，X与Z是d-separated的，如果我们不能把球从X中的任何节点发送到Z中的任何节点。条件概率语句（“给定Y”）由图中节点的阴影表示。下面是三种基本有向图结构的示例。    

![_config.yml]({{ site.baseurl }}/images/10708/image31.png)   

+ 在(a)和(b)中，阴影$$Y$$节点阻止球在节点$$X$$和$$Z$$之间移动。这给出了上节课中介绍的独立关系：$$X\bot Z\mid Y$$   

+ (c)又称“V-structure”，是一个特例。与前两个示例相反，如果节点$$Y$$为阴影，则球可以在$$X$$和$$Z$$之间移动，否则将被阻止。因此，右边的图$$X\bot Z$$。   

有了这些基本结构，我们可以对DAG应用规则。例如，让我们试着找出在给定$$X_{1},X_{6}$$时，$$X_{2},X_{3}$$相互独立。  

![_config.yml]({{ site.baseurl }}/images/10708/image32.png)   

阴影$$X_{1},X_{6}$$,球不能从$$X_{2}$$经过$$X_{1}$$到$$X_{3}$$,因为它被阻塞了。然而$$X_{2},X_{6},X_{5}$$是“V-structure”，球可以沿着这条路走$$X_{2},X_{6},X_{5},X_{3}$$.因此，独立声明无效。

# 有向和无向GMs的限制   

从表示( representational)的角度，我们的目标是找到一个图G，精确地捕捉给定分布$$P$$中的独立性。学习GMs的这个目标激发了下面的定义。 

**Perfect Maps**  

我们说$$g$$是独立集$$I$$的 perfect map (P-map) ，当$$I(g)=I$$。我们说$$g$$是分布$$P$$的 perfect map (P-map) ，当$$I(g)=I(P)$$。即$$sep_{g}(X;Z\mid Y)\Leftrightarrow P\models (X\bot Z\mid Y)$$

分布的P-map是唯一符合网络之间I-equivalent关系的图结构。也就是说，一个分布$$P$$可以有许多P-map，所有P-map都是I-equivalent。

(关于变量$$\chi$$的两个图结构$$K_{1},K_{2}$$,如果$$I(K_{1})=I(K_{2})$$则两个图结构是I-equivalent)

然而，任意分布$$P$$不一定能得到perfect maps,无论是无向或有向GMs的。下面是两个这样的例子。  

图模型族的维恩图图示，其中D是有向GM的族，而U是无向GM的族。  

![_config.yml]({{ site.baseurl }}/images/10708/image33.png)  

![_config.yml]({{ site.baseurl }}/images/10708/image34.png)  

左边:分布无法使用DGM表示，它需要$$A\bot C\mid \{B,D\}$$和$$B\bot D\mid \{A,C\}$$    
右边:这个 v-structure分布无法使用UGM表示。   


# 无向图形模型(Undirected Graphical Models)概述

+ 一对节点（随机变量）之间只能有对称关系。换句话说，从一个随机变量到另一个随机变量没有因果关系。
+ 模型可以表示分布的属性和构造，但不能显式地生成样本。
+ 每个节点都与其相邻节点有很强的相关性。

**示例**  

![_config.yml]({{ site.baseurl }}/images/10708/image35.png)  

让每个节点代表一个图像补丁。不可能分辨出这个图像块的内容如果将它与其他图像块隔离开来。然而，当我们观察它的相邻图像块时，我们可以看到它是一个水的图像块。由于相邻图像块之间的关系应该是对称的，因此图像最好用无向图形模型来表示。这种特殊的无向图形模型也称为网格模型。

# 定量(Quantitative Specification)    

## 团(Cliques)  

+ 团是完全连通的子图。(单个节点，有两个节点及以上时任意两两节点连通)   
+ 一个最大团是一个团，使得任何超集（包含这个子图的任何更大子图）不是一个完整的图。(最大团任意增加节点不再是团)  
+ 子团不一定是最大团  

**示例:**  

![_config.yml]({{ site.baseurl }}/images/10708/image36.png)  

![_config.yml]({{ site.baseurl }}/images/10708/image37.png)  

![_config.yml]({{ site.baseurl }}/images/10708/image38.png)  

## 势函数(Potential Functions)  

每个团可以与一个势函数$$\psi$$相关联，该势函数可以理解为其参数的一个临时函数，该函数为其联合分布分配一个预概率分数。这个势函数可以是任意的，但必须是非负的。

(参数，也叫参变量，是一个变量。如果我们引入一个或一些另外的变量来描述自变量与因变量的变化，引入的变量本来并不是当前问题必须研究的变量，我们把这样的变量叫做参变量或参数。)

为什么是团？团的每个组成部分都对势函数整体做出了贡献。 

**示例**  

用于说明势函数的示例。$$X_{1}$$和$$X_{2}$$都是二进制的。  

![_config.yml]({{ site.baseurl }}/images/10708/image39.png)   

对于$$\psi(X_{1},X_{2})$$，此表表示给定随机变量输入组合的势函数的值： 

![_config.yml]({{ site.baseurl }}/images/10708/image40.png)   

势函数不一定是概率，另一个用来说明势函数的例子：   

![_config.yml]({{ site.baseurl }}/images/10708/image41.png) 

这个模型意味着$$X\bot Z \mid Y$$。这个独立性声明意味着（根据定义）联合分布必须分解为： 

$$P(X,Y,Z)=P(Y)P(X\mid Y)P(Z\mid Y)\\
=P(X,Y)P(Z\mid Y)\\
=P(X\mid Y)P(Z,Y)$$   

概率分布可用作势函数。然而，在这种情况下，我们不能让所有的势都是边际概率或条件概率。所以这个图的势函数不能是概率分布。

## 吉布斯分布(Gibbs Distribution)与无向图形模型定义  

给定一个无向图$$H$$和与$$H$$团有关的团势函数$$\psi_{C}$$，我们说$$P$$是$$H$$上的Gibbs分布，当它可以表示为:   

$$P(X_{1},..X_{n})=\frac{1}{Z}\prod_{c\in C}\psi_{c}(\mathbf{x_{c}})$$   

其中$$Z$$又称为配分函数(partition function)。大写$$C$$表示所有团的集合，小写$$c$$表示与一组随机变量$$\mathbf{x}$$关联的团。  

无向图形模型通过无向图$$H$$,一组值为正的势函数$$\psi_{C}$$和$$H$$的相关团表示分布$$P(X_{1},..X_{n})$$：  

$$
P(X_{1},..X_{n})=\frac{1}{Z}\prod_{c\in C}\psi_{c}(\mathbf{x_{c}})\\
Z=\sum_{x_{1},..x_{n}}\prod_{c\in C}\psi_{c}(\mathbf{x_{c}})  
$$  

请注意，此分布是Gibbs分布。

## UGM Models 示例  

用于说明UGM的示例图：  

![_config.yml]({{ site.baseurl }}/images/10708/image42.png)   

**使用最大团(MAX CLIQUES):**      

![_config.yml]({{ site.baseurl }}/images/10708/image43.png)   

$$
P(A,B,C,D)=\frac{1}{Z}\psi_{c}(A,B,D)\psi_{c}(B,C,D)\\
Z=\sum_{A,B,C,D}\psi_{c}(A,B,D)\psi_{c}(B,C,D)
$$

我们只需要用两个3D表而不是一个4D表来表示离散节点。 

**使用成对的团(PAIRWISE CLIQUES):**     

![_config.yml]({{ site.baseurl }}/images/10708/image44.png)  

$$
P(A,B,C,D)=\frac{1}{Z}\psi_{c}(A,B)\psi_{c}(A,D)\psi_{c}(B,C)\psi_{c}(B,D)\psi_{c}(C,D)\\
Z=\sum_{A,B,C,D}\psi_{c}(A,B)\psi_{c}(A,D)\psi_{c}(B,C)\psi_{c}(B,D)\psi_{c}(C,D)
$$  

我们只需要用五个2D表而不是一个4D表来表示离散节点。  

**使用规范表示(CANONICAL REPRESENTATION)**  

即使我们使用细粒度的表示，Markov网络也常常被过度参数化。对于任何给定的分布，模型中都有多种参数可供选择。如上图所示，我们可以选择max-cliques或pairwise-cliques来表示这个模型。此外，在团结构中可能出现歧义。例如，给定一对派系$$ \{A,B\}$$和$$\{B,C\}$$，关于$$B$$的信息可以放在这两个团中的任何一个，导致可以通过多种方式定义相同的分布。  

规范表示提供了避免此问题的自然方法。它定义在所有非空的团上，如下所示。该公式执行包含排除计算，以确保每个随机变量只对整个函数贡献一次。  



# 定性(Qualitative Specification)   

# 全局马尔可夫性质的可靠性和完整性  

# 其他马尔可夫性质 

# 指数形式  

# 无向图示例  

参考：
[Lecture 2: Bayesian Networks](https://sailinglab.github.io/pgm-spring-2019/notes/lecture-02/)



