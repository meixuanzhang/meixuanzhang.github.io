---
layout: post
title: 第6章 基于模板的表示(补充)   
date:   2019-03-25
categories: ["Probabilistic Graphical Models"]
---  

所有个体都可以用相同的属性集进行描述，只是属性的值因个体的不同而不同。由于这种表示的关注点是随机变量的集合，因此这类模型称为基于变量的模型。  

构建一个单一、紧凑的模型，为同一类型的整个分布类提供模板：不同长度的轨迹，不同谱系。本章中定义了表示形式(representation)，允许我们在丰富结构空间上定义分布，结构由多个对象组成，并以各种方式互相关联。这是基于模板表示方法。  

# 时间模型(Temporal Models)    

对动态环境建模，对随着时间变化的世界状态进行推理。我们可以根据系统状态对此类环境进行建模，其在t时刻的值是系统的相关属性(隐藏或可观测)在t时刻的值。假定系统状态可以通过一组随机变量(随机变量集)$$\chi$$里的变量的赋值来表示。令$$X_{i}^{(t)}$$表示变量$$X_{i}$$在时刻t的实例化。$$X_{i}$$不再是取某个值的变量，而是一个模板变量(template variable).该模板在不同时刻t被实例化，每个$$X_{i}^{(t)}$$是变量，在$$Val(X_{i})$$取值.    

对变量集$$\mathbf{X}\subseteq \chi$$，使用$$\mathbf{X}^{t_{1}:t_{2}}(t_{1} < t_{2})$$定义变量集合$$\{\mathbf{X}^{t}:t\in [t_{1},t_{2}]\}$$ ，使用$$\mathbf{x}^{t:t'}$$表示对这个变量集合的一个赋值

现在，每一个“可能世界”在概率空间中是一条轨迹(trajectory)：对每个相关的时刻t,为每个变量$$X_{i}^{t}$$赋值，目标是在这样的轨迹上表示联合分布。   

## 基本假设  

第一种是将时间轴离散化为一组时间片段(time slice),系统状态在间隔为$$\triangle$$的规则区间上测定，其中$$\triangle$$为预先指定的时间粒度。$$\chi^{(t)}$$表示系统在时刻$$t\cdot \triangle$$时状态的基础随机变量。  

在预先指定的采样时间$$t=0,..,T$$的轨迹上考虑分布$$P(\chi^{(0)},\chi^{(1)},...,\chi^{(T)})$$,该分布通常简写为$$P(\chi^{(0:T)})$$,在与时间一致的方向上，用概率链式法则可以将分布重新参数化：   

$$P(\chi^{(0:T)})=P(\chi^{(0)})\prod_{t=0}^{T-1}P(\chi^{(t+1)}\mid \chi^{(0:t)})$$ 

对模板变量$$\chi$$上动态系统，如果对于所有$$t\ge 0$$,下式成立：  

$$(\chi^{(t+1)} \bot \chi^{(0:(t-1))}\mid \chi^{(t)})$$   

则称动态系统满足马尔可夫假设(Markov assumption),并成该系统为马尔可夫系统(Markovian system),马尔可夫假设规定，对于$$t'<t$$,$$\chi^{(t+1)}$$中的变量不能直接依赖$$\chi^{(t')}$$的变量。马尔可夫假设将分布定义为更紧凑的表示：  

$$P(\chi^{(0)},\chi^{(1)},...,\chi^{(T)})=P(\chi^{(0)})\prod_{t=0}^{T-1}P(\chi^{(t+1)}\mid \chi^{(t)})$$

因为这个过程可以无限地持续下去，在过程范围有限的情况下，等式依然让我们面临获得条件分布是一个无限集，或一个非常大的集合的任务，通常需要制定最后一个简化假设   

如果对所有的$$t$$，$$P(\chi^{(t+1)}\mid \chi^{(t)})$$相同，那么马尔可夫动态系统称为平稳的(stationary)(也称为时不变或时齐)。这种情况下，该过程可以用转移模型(transition model)$$P(\chi^{'}\mid \chi)$$来表示，并且使得对任意的$$t\ge 0$$    

$$P(\chi^{(t+1)}= \xi^{'} \mid \chi^{(t)}= \xi)=P(\chi^{'} = \xi^{'} \mid \chi = \xi)$$

## 动态贝叶斯网  

马尔可夫假设和平稳性假设可以使我们在无限轨迹上非常紧凑的表示概率分布：只需要表示初始状态分布和转移模型$$P(\chi^{'}\mid \chi)$$，转移模型是条件概率分布，可以使用条件贝叶斯网表示。  

在$$\xi$$上的一个过程的2-time-slice 贝叶斯网(2-TBN)式在给定$$\xi_{I}$$时$$\xi^{'} $$条件贝叶斯网络，其中$$\xi_{I}\subseteq \xi$$是界面变量   


在条件贝叶斯网络中，只有$$\xi^{'}$$中的变量有父节点或CPD.界面变量(interface variable)$$\xi^{I}$$指那些在$$t$$时刻的值对$$t+1$$时刻的值有直接影响的变量。只有在$$\xi^{I}$$中的变量才能成为$$\chi^{'}$$中变量的父节点。下例，除变量$$O$$之外，所有的变量都是界面变量。总之，2-TBN表示如下条件分布：  

$$P(\xi^{'} \mid \xi)=P(\xi^{'} \mid \xi_{I})=\prod_{i=1}^{n}P(X_{i}^{'}\mid Pa_{X_{i}^{'}})$$    

对每个模板变量$$X_{i}$$,CPD $$P(\xi^{'} \mid  Pa_{X_{i}^{'}})$$是一个模板因子(template factor):对于多个$$X_{i}^{(t)}$$(以及它们的父节点),它会在模型中被多次实例化   




参考：



