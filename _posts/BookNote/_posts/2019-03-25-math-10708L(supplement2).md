---
layout: post
title: 第6章 基于模板的表示(补充)   
date:   2019-03-25
categories: ["Probabilistic Graphical Models"]
---  

所有个体都可以用相同的属性集进行描述，只是属性的值因个体的不同而不同。由于这种表示的关注点是随机变量的集合，因此这类模型称为基于变量的模型。  

构建一个单一、紧凑的模型，为同一类型的整个分布类提供模板：不同长度的轨迹，不同谱系。本章中定义了表示形式(representation)，允许我们在丰富结构空间上定义分布，结构由多个对象组成，并以各种方式互相关联。这是基于模板表示方法。  

# 时间模型(Temporal Models)    

对动态环境建模，对随着时间变化的世界状态进行推理。我们可以根据系统状态对此类环境进行建模，其在t时刻的值是系统的相关属性(隐藏或可观测)在t时刻的值。假定系统状态可以通过一组随机变量(随机变量集)$$\chi$$里的变量的赋值来表示。令$$X_{i}^{(t)}$$表示变量$$X_{i}$$在时刻t的实例化。$$X_{i}$$不再是取某个值的变量，而是一个模板变量(template variable).该模板在不同时刻t被实例化，每个$$X_{i}^{(t)}$$是变量，在$$Val(X_{i})$$取值.    

对变量集$$\mathbf{X}\subseteq \chi$$，使用$$\mathbf{X}^{t_{1}:t_{2}}(t_{1} < t_{2})$$定义变量集合$$\{\mathbf{X}^{t}:t\in [t_{1},t_{2}]\}$$ ，使用$$\mathbf{x}^{t:t'}$$表示对这个变量集合的一个赋值

现在，每一个“可能世界”在概率空间中是一条轨迹(trajectory)：对每个相关的时刻t,为每个变量$$X_{i}^{t}$$赋值，目标是在这样的轨迹上表示联合分布。   

## 基本假设  

第一种是将时间轴离散化为一组时间片段(time slice),系统状态在间隔为$$\triangle$$的规则区间上测定，其中$$\triangle$$为预先指定的时间粒度。$$\chi^{(t)}$$表示系统在时刻$$t\cdot \triangle$$时状态的基础随机变量。  

在预先指定的采样时间$$t=0,..,T$$的轨迹上考虑分布$$P(\chi^{(0)},\chi^{(1)},...,\chi^{(T)})$$,该分布通常简写为$$P(\chi^{(0:T)})$$,在与时间一致的方向上，用概率链式法则可以将分布重新参数化：   

$$P(\chi^{(0:T)})=P(\chi^{(0)})\prod_{t=0}^{T-1}P(\chi^{(t+1)}\mid \chi^{(0:t)})$$ 

对模板变量$$\chi$$上动态系统，如果对于所有$$t\ge 0$$,下式成立：  

$$(\chi^{(t+1)} \bot \chi^{(0:(t-1))}\mid \chi^{(t)})$$   

则称动态系统满足马尔可夫假设(Markov assumption),并成该系统为马尔可夫系统(Markovian system),马尔可夫假设规定，对于$$t'<t$$,$$\chi^{(t+1)}$$中的变量不能直接依赖$$\chi^{(t')}$$的变量。马尔可夫假设将分布定义为更紧凑的表示：  

$$P(\chi^{(0)},\chi^{(1)},...,\chi^{(T)})=P(\chi^{(0)})\prod_{t=0}^{T-1}P(\chi^{(t+1)}\mid \chi^{(t)})$$

因为这个过程可以无限地持续下去，在过程范围有限的情况下，等式依然让我们面临获得条件分布是一个无限集，或一个非常大的集合的任务，通常需要制定最后一个简化假设   

如果对所有的$$t$$，$$P(\chi^{(t+1)}\mid \chi^{(t)})$$相同，那么马尔可夫动态系统称为平稳的(stationary)(也称为时不变或时齐)。这种情况下，该过程可以用转移模型(transition model)$$P(\chi^{'}\mid \chi)$$来表示，并且使得对任意的$$t\ge 0$$    

$$P(\chi^{(t+1)}= \xi^{'} \mid \chi^{(t)}= \xi)=P(\chi^{'} = \xi^{'} \mid \chi = \xi)$$

## 动态贝叶斯网  

马尔可夫假设和平稳性假设可以使我们在无限轨迹上非常紧凑的表示概率分布：只需要表示初始状态分布和转移模型$$P(\chi^{'}\mid \chi)$$，转移模型是条件概率分布，可以使用条件贝叶斯网表示。  

在$$\chi$$上的一个过程的2-time-slice 贝叶斯网(2-TBN)是一个在给定$$\chi_{I}$$时$$\chi^{'}$$条件贝叶斯网络，其中$$\chi_{I}\subseteq \chi$$是界面变量的集合    


在条件贝叶斯网络中，只有$$\chi^{'}$$中的变量有父节点或CPD.界面变量(interface variable)$$\chi_{I}$$指那些在$$t$$时刻的值对$$t+1$$时刻的值有直接影响的变量。只有在$$\chi_{I}$$中的变量才能成为$$\chi^{'}$$中变量的父节点。下例，除变量$$O$$之外，所有的变量都是界面变量。

![_config.yml]({{ site.baseurl }}/images/10708s/image5.png)  

总之，2-TBN表示如下条件分布：  

$$P(\chi^{'} \mid \chi)=P(\chi^{'} \mid \chi_{I})=\prod_{i=1}^{n}P(X_{i}^{'}\mid Pa_{X_{i}^{'}})$$    

对每个模板变量$$X_{i}$$,CPD $$P(\chi^{'} \mid  Pa_{X_{i}^{'}})$$是一个模板因子(template factor):对于多个$$X_{i}^{(t)}$$(以及它们的父节点),它会在模型中被多次实例化   

![_config.yml]({{ site.baseurl }}/images/10708s/image6.png)   

隐马尔可夫模型(hidden Markov model)是这类时序模型的一个简单的例子，将HMM视为一个DBN(动态贝叶斯网)，那么HMM有下图所示结构：   

![_config.yml]({{ site.baseurl }}/images/10708s/image6.png)  

在2-TBN中，位于时间片之间的边称为时间片间的边(inter-time-slice edge),而连接同一时间片中变量的边称为时间片内的边(intra-time-slice edge)   

动态贝叶斯网(dynamic Bayesian network,DBN)是一对$$<\beta_{0},\beta_{\to}>$$,其中$$\beta_{0}$$是$$\chi^{(0)}$$上表示状态的初始分布的贝叶斯网，$$\beta_{\to}$$是过程的一个2-TBN。对任意需要时间跨度$$T\ge 0$$,$$\chi^{(0:T)}$$上的分布定义为展开的贝叶斯网(unrolled Bayesian network),其中，对任意的$$i=1,..,n$$:   

+ $$X_{i}^{(0)}$$的结构和CPD与$$X_{i}$$在$$\beta_{0}$$中的一致  

+ 对$$t>0$$,$$X_{i}^{(t)}$$的结构和CPD与$$X_{i}^{(')}$$在$$\beta_{\to}$$中的一致   

这样，可以把DBN视为一种紧凑的表示，并通过它可以产生贝叶斯网(对每个$$T>0$$)的一个无限集。  

下图显示了两类由HMM构造的有用的DBN。左边因子HMM，它的2-TBN具有一系列链式结构$$X_{i} \to X_{i}^{'},(i=1,...,n)$$,具有一个单一的(通常)观测变量$$Y'$$,它是所有变量$$X_{i}^{'}$$的子节点。右边耦合的HMM同一由一系列$$X^{'}$$链构造，但每条链是有其自己私有观测变量$$Y_{i}$$的一个HMM.

![_config.yml]({{ site.baseurl }}/images/10708s/image7.png)  

## 状态-观测模型  

另一种考虑时序过程的方法是状态-观测模型(state-observation model).  

状态-观测模型利用了两个独立性假设：状态以马尔可夫方式进化，所以： 

$$(X^{(t+1)} \perp X^{(0:(t+1))} \mid X^{(t)})$$  

并且当给定$$t$$时刻的状态，$$t$$时刻的观测变量与整个状态序列条件独立：  

$$(O^{(t)} \perp X^{(0:(t-1))} , X^{(t+1:\infty)}\mid X^{(t)})$$

现在可以认为概率模型由两部分组成：转移模型(transition model)$$P(X'\mid X)$$和观测模型(observation model)$$P(O\mid X)$$

# 模板和模板因子 

模板(template)在模型定义中是一个关键的概念，在模型中被多次实例化。模板使我们可以对包含多个有相同值的空间和相同语义的随机变量的模型进行刻画。比如我们有一个Blood-Type模板，它有一个特殊取值空间(A,B,AB,O),并且在同一谱系内对多个个体重复使用。将属性或模板变量与模板区分开，Blood-Type是模板，Blood-Type(Bart)是模板变量或属性，Bart是其参数取值。  

实例化：给定一组模板属性，可以用不同的方式实例化它们，进而产生具有多个相同类型的随机变量的概率空间。例如，我们可以考虑一所拥有一组学生和一组课程的特定大学，并对不同的(学生，课程)对是s,c定义包含随机变量Grade(s,c)的一个概率空间。这个模型在多个学生在多门课程上的分数编码了一个联合分布。  

# 对象-关系领域的有向概率模型  

## Plate 模型  

在Plate的形式体系中，对象类型称为plate.在类中多个对象共享相同的属性集合相同的概率模型的事实。术语“plate”意味存在一大堆相同的对象。 

### 示例  

图中描述了从同一个分布中生成的多个随机变量。即存在一个所有变量都从同一个分布中采样并且具有相同的值域$$Val(X)$$的随机变量集$$X(d)(d\in D)$$.在plate表示中，通过只画出单一的节点$$X(d)$$,并将其封闭在一个方框中可表示$$d$$包含于$$D$$,我们编码了这些变量全部产生于同一个模板的事实。方框代表整“堆”这些相同分布的变量。该方框称为一个plate,通过类比，它还可以代表了一堆相同的plate   

很多情况下，我们希望对这些变量有相同分布这一事实进行明确编码，为此经常把表示变量$$X(d)$$从中采样的CPD的参数化变量$$\theta_{X}$$明确的添加到模型中。  

![_config.yml]({{ site.baseurl }}/images/10708s/image8.png)   

例子：  

![_config.yml]({{ site.baseurl }}/images/10708s/image9.png)   

![_config.yml]({{ site.baseurl }}/images/10708s/image10.png)   

![_config.yml]({{ site.baseurl }}/images/10708s/image11.png)   

6.7(b),导出的网络中，变量Intelligence不是关联到学生，而是关联到偶对(学生，课程)。如果学生选修了两门课程，那么需要两个不同的变量来表示他的智力，而且这两个变量可以取不同的值。

![_config.yml]({{ site.baseurl }}/images/10708s/image12.png)   

![_config.yml]({{ site.baseurl }}/images/10708s/image13.png)   

![_config.yml]({{ site.baseurl }}/images/10708s/image14.png)   

$$B$$是父节点

参考：



