---
layout: post
title: week1 操作系统概述
date:   2019-03-26
categories: ["Operating Systems"]  
---   

[操作系统原理笔记](https://www.coursera.org/learn/os-pku/home/week/1)  

# 1、操作系统做了什么  

{% highlight c %}
#include<stdio.h>  
int main(int argc, char *argv[])
{
puts("Hello World");
return 0;
}
{% endhighlight %}   

程序执行过程：  

+ 用户告诉操作系统执行helloworld程序(如何告知？通过命令行输入命令或鼠标点击相应的图标)   

+ 操作系统：找到helloworld程序的相关信息，检查其类型是否是可执行文件；并通过程序首部信息确定代码和数据在可执行文件中的位置并计算出对应的磁盘块地址(文件格式？windows是PE,Linux是ELF)   

+ 为了执行程序，操作系统：创建一个新的进程，并将helloworld可执行文件格式映射到该进程结构，表示由该进程执行helloworld程序  

+ 操作系统把控制权交给调度程序：(假设调度程序选中helloworld程序) 操作系统：为helloworld程序设置CPU上下文环境，并跳到程序开始处。  

+ 执行helloworld程序第一条指令，发生缺页异常(程序在执行的时候，先要把程序的代码和数据读入内存CPU才能去执行，但是helloworld程序的代码和数据还没有读入内存，所以硬件机制就会捕获出缺页异常，把控制权交给操作系统)    

+ 操作系统：分配一页物理内存，并将代码从磁盘读入内存(根据前面计算出的磁盘块地址把helloworld程序的代码读入内存)，然后继续执行helloworld程序  

(有的时候程序很大 一页内存还不够，因此在这个执行过程中会多次地产生缺页异常 然后去到磁盘读入程序到内存)  

+ helloworld程序执行puts函数(系统调用)，在显示器上写一字符   

+ 操作系统：找到要将字符串送往的显示设备，通常设备是由一个进程控制的，所以操作系统将要写的字符送给该进程  

+ 操作系统：控制设备的进程告诉设备的窗口系统它要显示字符串，窗口系统确定这是一个合法的操作，然后将字符串转换为像素 把像素写入设备的存储映像区   

+ 视频硬件将像素转换成显示器可接收的一组控制/数据信号   

+ 显示器解释信号，激发液晶屏   

+ 屏幕显示"Hello World"  

**上述步骤得出**   

![_config.yml]({{ site.baseurl }}/images/88OS/image1.png)  

在执行的时，需要操作系统来创建进程，因此到操作系统创建进程，进程创建完，从操作系统返回接着执行这个helloworld程序，出现了缺页异常以后呢，控制权又转回了操作系统 操作系统分配物理内存，给这个用户程序，然后又转向用户程序接着执行，然后helloworld程序又要去执行puts函数，又转向了操作系统    

**换个角度看用户程序执行**   

![_config.yml]({{ site.baseurl }}/images/88OS/image2.png)  

操作系统在执行过程中，如果选中了一个程序，会通过调度选中这个程序，执行这个程序，程序执行过程中，会不断地去陷入操作系统，由操作系统完成一些服务，然后再通过调度再选中程序，接着执行

一个程序的 执行过程中，操作系统负责了这个程序的启动过程 负责了这个程序执行的过程，同时在执行的过程中，不断地去为用户程序的执行 提供各种各样的支持  

# 2、操作系统的定义和作用    

操作系统是计算机系统中的一个系统软件，是一些程序模块的集合， 这些程序模块相互协作、相互配合来完成以下这些功能：  

+ 它们能以尽量有效、合理的方式组织和管理计算机的各种软硬件资源   

+ 为了支持程序的执行，操作系统要合理地组织计算机的工作流程，控制程序的执行并向用户提供各种服务功能。  

+ 操作系统必须采用各种各样的方式使得用户能够非常灵活、方便地使用计算机，采用各种各样的技术使整个的计算机系统能够高效率地运行    

**解读关键词**  

有效：系统效率。资源利用率(CPU利用率充足与否？I/O设备是否忙碌？希望通过操作系统能够把各种各样的资源的利用率提高 以提高整个的操作系统)  

合理： 各种软硬件资源的管理是否公平合理(如果不公平、不合理，则可能会产生问题?)      

方便使用： 用户界面和编程接口(希望能够非常容易地使用操作系统提供给我们的各种接口。 用户界面也就是通过命令行，用户和操作系统打交道,编程接口也就是程序员通过开发软件，在软件中与操作系统打交道 )  

**操作系统的三个作用**   

**1、资源的管理者(有效)**  

从操作系统内部的角度来看操作系统是资源的管理者  

![_config.yml]({{ site.baseurl }}/images/88OS/image3.png)    

![_config.yml]({{ site.baseurl }}/images/88OS/image4.png)    

数据结构是用于记录资源的使用情况，有了数据结构之后还需要算法，也就是说操作系统要确定资源分配策略，操作系统要决定把资源分给哪一个进程用，给它用多久，给它用多少   

静态分配策略就是说一个程序在执行前把它所需的各种资源拿到手，那么这个程序在执行过程中就不再需要新的资源，就可以一直执行完成。静态分配策略会导致整个资源的浪费，有的时候不需要用资源的时候，它拿着资源，别的进程不能用。    

绝大多数操作系统都采用的是一个动态分配策略 那么动态分配策略就是说在一个进程执行的过程中，需要资源时才提出申请。      

例子：页式的存储管理系统，把物理内存划分出很多的物理页面，可以用一个非常简单的数据结构位示图，或者位图 bitmap 来记录这个物理内存的使用情况，一位对应了物理内存的一页，如果这一页是空闲的，那么我们这里头就记为0，如果这一位是分出去了，那我们就记为1,分配算法就实际上就是在这个数据结构上执行。    

分配的过程实际上就是按照策略，按照制定的这种资源分配策略选中要给分配资源的这个进程，然后去决定分配给它多少，然后去修改相应的数据结构。如：如果我们把一内存分配给了一个进程，那么这个位示图就会把这个原来的0改成1，当一个进程使用完资源之后，系统要把它回收 修改相应的数据结构，把原来的1换成0，这就是实施资源分配的和回收的过程   

采用各种各样的技术来提高资源的利用率   

保护资源：使一个进程使用资源的过程不被另外一个进程所干扰 如果在一个系统中有多个进程都对资源有申请，那么产生了冲突的情况下，需要操作系统来协调  

操作系统的五大基本功能：  

![_config.yml]({{ site.baseurl }}/images/88OS/image5.png)   

**2、向用户提供各种服务(方便使用)**  

![_config.yml]({{ site.baseurl }}/images/88OS/image6.png)   

![_config.yml]({{ site.baseurl }}/images/88OS/image7.png) 

操作系统完成各种各样的功能，在操作系统之上是应用程序，操作系统为应用程序的执行提供了各种各样的接口，用户的接口和编程的接口，这些就组成了一个虚拟机器界面。 操作系统之下是硬件，操作系统屏蔽了一些硬件的细节，用户程序不需要直接和硬件打交道，通常它都是通过操作系统来控制这些硬件的执行   

那么为什么要用操作系统把硬件屏蔽？因为与硬件相关的一些工作是非常复杂和繁琐的。    

![_config.yml]({{ site.baseurl }}/images/88OS/image8.png) 

**3、对硬件机器的扩展(扩展能力)**   

操作系统就,在应用程序与硬件之间 建立了这么一个等价的一个扩展机器(虚拟机(，那么通过对硬件的抽象提高了整个系统的可移植性,对于程序员提供了这样一个操作系统之后，编程就会比对底层硬件编程更容易

![_config.yml]({{ site.baseurl }}/images/88OS/image9.png) 

**操作系统的三个作用**  

+ 有效第管理资源  

+ 通过命令接口，编程接口等为用户提供各种功能服务  

+ 对硬件机器扩展  

# 3、操作系统的主要特征   

并发、共享、虚拟、随机    

![_config.yml]({{ site.baseurl }}/images/88OS/image10.png) 

操作系统来回管理多个活动，活动和活动之间要有切换    

很多的程序都在内存，需要对内存进行保护，使活动之间互不干扰     

有些问题需要活动相互配合解决，这些相互依赖的活动之间需要解决它的同步等问题   

在宏观上，这些程序好像都在执行着，但是在微观上呢，由于只有一个 CPU，所以任何时刻只有一个程序真正在 CPU 上执行，那可以说这些程序是在 CPU 上是轮流执行，轮流过程需要操作系统提供相应的支持  

并行，多指的是不同的程序同时在多个硬件部件上执行 也就是它会有硬件的多个部件的支持。  

![_config.yml]({{ site.baseurl }}/images/88OS/image11.png) 

互斥共享，比如说像打印机，打印机给一个进程用就不能同时给另外一个进程用。一个进程用完了可以分给另外一个进程用。  

同时共享，两个或两个以上的进程，共享一段代码。不同的文件都放在磁盘上，这个磁盘是共享   

共享就会给操作系统带来管理上的复杂性，操作系统要考虑如何来保护资源 使得不同的进程之间不会互相干扰    

![_config.yml]({{ site.baseurl }}/images/88OS/image12.png)   

假定只有一个物理CPU，宏观上在单CPU上跑了很多的进程，每个进程实际是在虚拟 CPU 上在跑。微观上，每次只有一个进程在一个 CPU 上去跑。 

对于存储器，操作系统给每个进程分配了一个地址空间 这地址空间是一个虚拟地址空间，各个进程之间在相互独立的空间，空间里里放了进程的代码、数据、堆、栈等等，每个进程都有自己的地址空间，那这是逻辑的。 在物理上它会共用一块物理内存。

在显示设备上我们可以开多个窗口或者是虚拟终端，一个显示设备可以显示在不同窗口或者虚拟终端显示不同的内容  

![_config.yml]({{ site.baseurl }}/images/88OS/image13.png)    

 

# 4、典型操作系统的架构  

# 5、操作系统的分类1  

# 6、操作系统的分类2


